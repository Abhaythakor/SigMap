-- 007_vulnerability_details.sql

CREATE TABLE IF NOT EXISTS vulnerability_details (
    id SERIAL PRIMARY KEY,
    cve_id VARCHAR(50) NOT NULL,
    technology VARCHAR(255) NOT NULL,
    description TEXT,
    severity_score NUMERIC(3,1),
    severity_label VARCHAR(50), -- Low, Medium, High, Critical
    bug_type VARCHAR(100),      -- e.g., XSS, SQLi, RCE
    exploit_available BOOLEAN DEFAULT FALSE,
    published_at TIMESTAMP WITH TIME ZONE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(cve_id, technology)
);

CREATE INDEX idx_vuln_details_tech ON vulnerability_details(technology);
CREATE INDEX idx_vuln_details_cve ON vulnerability_details(cve_id);
CREATE INDEX idx_vuln_details_severity ON vulnerability_details(severity_label);
