-- 004_vulnerability_profile.sql

CREATE TABLE IF NOT EXISTS technology_vuln_profile (
    id SERIAL PRIMARY KEY,
    technology VARCHAR(255) NOT NULL UNIQUE,
    cve_count INT DEFAULT 0,
    high_count INT DEFAULT 0,
    exploit_available BOOLEAN DEFAULT FALSE,
    poc_available BOOLEAN DEFAULT FALSE,
    exploited_in_wild BOOLEAN DEFAULT FALSE,
    risk_level VARCHAR(50) DEFAULT 'Low',
    last_checked TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_vuln_tech ON technology_vuln_profile(technology);
CREATE INDEX idx_vuln_risk ON technology_vuln_profile(risk_level);
